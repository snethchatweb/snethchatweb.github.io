<!DOCTYPE html>
<html lang="pt-BR">
<head>
  <title>Chat com Copilot</title>
  <link rel="shortcut icon" href="icon.png" type="image/x-icon">
                
  <style>
    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    body {
      font-family: Arial, sans-serif;
      background: linear-gradient(to right, lightblue, lightgreen);
    }

    #container {
      display: flex;
      height: 100vh;
    }

    #sidebar {
      width: 25%;
      background: white;
      overflow-y: scroll;
    }

    #sidebar h1 {
      text-align: center;
      padding: 10px;
      color: blue;
    }

    #sidebar ul {
      list-style: none;
    }

    #sidebar li {
      padding: 10px;
      border-bottom: 1px solid lightgray;
    }

    #sidebar li.active {
      background: lightblue;
    }

    #sidebar li:hover {
      cursor: pointer;
      background: lightgreen;
    }

    #main {
      width: 75%;
      background: white;
      overflow-y: scroll;
    }

    #main h1 {
      text-align: center;
      padding: 10px;
      color: green;
    }

    #main ul {
      list-style: none;
      padding: 10px;
    }

    #main li {
      margin: 10px;
      padding: 10px;
      border-radius: 10px;
    }

    #main li.sent {
      background: lightgreen;
      align-self: flex-end;
    }

    #main li.received {
      background: lightblue;
      align-self: flex-start;
    }

    #input {
      display: flex;
      align-items: center;
      background: lightgray;
      padding: 10px;
    }

    #input input {
      flex: 1;
      border: none;
      outline: none;
      padding: 10px;
    }

    #input button {
      border: none;
      outline: none;
      background: blue;
      color: white;
      padding: 10px;
      margin-left: 10px;
    }

    #input button:hover {
      cursor: pointer;
      background: green;
    }
  </style>
</head>
<body>
  <div id="container">
    <div id="sidebar">
      <h1>Sneth Chat Web</h1>
      <ul id="contacts">
        <li class="active">Contatos</li>
        <li>Grupos</li>
        <li>Status</li>
      </ul>
    </div>
    <div id="main">
      <h1>Conversa com <span id="user-name"></span></h1>
      <ul id="messages">
      </ul>
      <div id="input">
        <input type="text" id="message-input" placeholder="Digite sua mensagem...">
        <button id="send-button">Enviar</button>
      </div>
    </div>
  </div>
  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.2.9/firebase-database.js"></script>
  <script>
    // Initialize Firebase
    var firebaseConfig = {
      apiKey: "AIzaSyBbCOS02NPFgFKK8X6tIG-4gwFCZ2WgyZY",
      authDomain: "sneth-chat-51c06.firebaseapp.com",
      databaseURL: "https://sneth-chat-51c06-default-rtdb.firebaseio.com",
      projectId: "sneth-chat-51c06",
      storageBucket: "sneth-chat-51c06.appspot.com",
      messagingSenderId: "245152719854",
      appId: "1:245152719854:web:a5867e51fa8ff7609be4ff"
    };
    firebase.initializeApp(firebaseConfig);

    // Get elements
    var contacts = document.getElementById("contacts");
    var userName = document.getElementById("user-name");
    var messages = document.getElementById("messages");
    var messageInput = document.getElementById("message-input");
    var sendButton = document.getElementById("send-button");

    // Set user ids
    var myId = "user1"; // You can change this to any string
    var otherId = "user2"; // You can change this to any string

    // Set user name
    userName.textContent = otherId;

    // Listen for contacts click
    contacts.addEventListener("click", function(e) {
      var target = e.target;
      if (target.tagName === "LI") {
        // Remove active class from previous li
        var active = contacts.querySelector(".active");
        if (active) {
          active.classList.remove("active");
        }
        // Add active class to current li
        target.classList.add("active");
        // Clear messages
        messages.innerHTML = "";
        // Set user name
        userName.textContent = target.textContent;
        // Set other id
        otherId = target.textContent;
        // Load messages
        loadMessages();
      }
    });

    // Listen for send button click
    sendButton.addEventListener("click", function() {
      // Get message text
      var messageText = messageInput.value;
      // Check if not empty
      if (messageText) {
        // Clear input
        messageInput.value = "";
        // Send message to Firebase
        sendMessage(messageText);
      }
    });

    // Listen for enter key press
    messageInput.addEventListener("keypress", function(e) {
      if (e.keyCode === 13) {
        // Trigger send button click
        sendButton.click();
      }
    });

    // Function to send message to Firebase
    function sendMessage(messageText) {
      // Get current timestamp
      var timestamp = Date.now();
      // Create message object
      var message = {
        sender: myId,
        receiver: otherId,
        text: messageText,
        time: timestamp
      };
      // Push message to Firebase
      firebase.database().ref("messages").push(message);
    }

    // Function to load messages from Firebase
    function loadMessages() {
      // Get messages reference
      var messagesRef = firebase.database().ref("messages");
      // Listen for new messages
      messagesRef.on("child_added", function(snapshot) {
        // Get message data
        var message = snapshot.val();
        // Check if message is for current chat
        if ((message.sender === myId && message.receiver === otherId) || (message.sender === otherId && message.receiver === myId)) {
          // Display message
          displayMessage(message);
        }
      });
    }

    // Function to display message
    function displayMessage(message) {
      // Create li element
      var li = document.createElement("li");
      // Set li class based on sender
      li.className = message.sender === myId ? "sent" : "received";
      // Set li text
      li.textContent = message.text;
      // Append li to messages
      messages.appendChild(li);
      // Scroll to bottom
      messages.scrollTop = messages.scrollHeight;
    }

    // Load messages initially
    loadMessages();
  </script>
</body>
</html>
